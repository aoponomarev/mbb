# Принципы работы с компонентами

> Оглавление `docs/doc-comp-principles.md`
- § *Приоритет библиотек* — использование готовых библиотек перед кастомными компонентами.
- § *Использование Bootstrap* — нативные компоненты Bootstrap вместо кастомных обёрток.
- § *Запрет кастомных стилей* — использование только Bootstrap классов и утилит.
- § *Адаптивность компонентов* — управление видимостью элементов через CSS классы.

> § <br> ПРИОРИТЕТ БИБЛИОТЕК

Перед созданием кастомного компонента **обязательно** проверь наличие подходящих Vue-библиотек с расширяемым API. Приоритет библиотекам, которые имеют плагины, composables, возможность кастомизации. Кастомные компоненты создаются только если библиотека не существует, слишком тяжёлая или требуется специфичная бизнес-логика. Подробности в `docs/doc-lib-vue.md`.

> § <br> ИСПОЛЬЗОВАНИЕ BOOTSTRAP

## Базовый принцип

Нативные компоненты Bootstrap 5 (dropdown, modal, tooltip, popover и т.п.) используются напрямую через классы и JavaScript API без создания кастомных Vue-обёрток. Bootstrap предоставляет полный функционал: клавиатурную навигацию, позиционирование через Popper.js, управление через JavaScript API, поддержку тем.

## Когда создавать Vue-обёртки

Кастомные Vue-компоненты-обёртки над Bootstrap создаются **только** если требуется дополнительная функциональность, которой нет в нативном Bootstrap:
- Поиск по элементам (например, в dropdown)
- Прокрутка для длинных списков
- Кастомная логика фильтрации/сортировки
- Динамическая загрузка элементов

**Важно:** Кастомные компоненты создаются только для элементов внутри нативных Bootstrap-компонентов (например, пункты меню внутри `dropdown-menu`). Контейнеры Bootstrap (`<div class="dropdown">`, `<div class="modal">` и т.п.) остаются под управлением Bootstrap без Vue-обёрток, **кроме случаев**, когда требуется расширенная функциональность.

## Стратегия максимальной совместимости с Bootstrap (обязательное требование)

При создании Vue-обёрток над Bootstrap-компонентами **обязательно** соблюдать следующие принципы:

1. **Инициализация через Bootstrap JavaScript API:**
   - Использовать `new bootstrap.Dropdown()`, `new bootstrap.Modal()` и т.п.
   - Сохранять ссылку на экземпляр Bootstrap в `data()` или `ref`
   - Инициализировать в `mounted()` через `$nextTick()`

2. **Подписка на события Bootstrap:**
   - Подписываться на события Bootstrap (`show.bs.dropdown`, `hide.bs.dropdown`, `shown.bs.modal` и т.п.)
   - Синхронизировать состояние Vue с состоянием Bootstrap
   - Эмитить события Vue на основе событий Bootstrap

3. **Программный доступ к Bootstrap API:**
   - Предоставлять методы для программного управления (`show()`, `hide()`, `toggle()`)
   - Предоставлять метод `getBootstrapInstance()` для прямого доступа к экземпляру Bootstrap
   - Не блокировать стандартные способы управления Bootstrap

4. **Уничтожение экземпляров:**
   - Вызывать `instance.dispose()` в `beforeUnmount()` для предотвращения утечек памяти
   - Очищать подписки на события

5. **Использование нативных атрибутов Bootstrap:**
   - Сохранять `data-bs-toggle`, `data-bs-target` и другие data-атрибуты
   - Не переопределять стандартное поведение Bootstrap без необходимости

6. **Совместимость с темами:**
   - Использовать только Bootstrap классы и CSS-переменные
   - Не добавлять кастомные стили, которые могут конфликтовать с темами

**Пример правильной реализации:**
```javascript
mounted() {
    this.$nextTick(() => {
        if (window.bootstrap && window.bootstrap.Dropdown) {
            this.dropdownInstance = new window.bootstrap.Dropdown(toggleElement);

            // Подписка на события Bootstrap
            container.addEventListener('show.bs.dropdown', () => {
                this.isOpen = true;
                this.$emit('show');
            });
        }
    });
},

beforeUnmount() {
    if (this.dropdownInstance) {
        this.dropdownInstance.dispose();
    }
},

methods: {
    show() {
        if (this.dropdownInstance) {
            this.dropdownInstance.show();
        }
    },

    getBootstrapInstance() {
        return this.dropdownInstance;
    }
}
```

> § <br> ЗАПРЕТ КАСТОМНЫХ СТИЛЕЙ

Все компоненты используют только Bootstrap классы и утилиты. Кастомный CSS, inline-стили и `<style>`-блоки запрещены, кроме минимальных исключений (например, inline `transition` для анимации chevron в `dropdown-menu-item`). Подробности в `docs/doc-architect.md` (раздел "Фреймворки и UI").

> § <br> АДАПТИВНОСТЬ КОМПОНЕНТОВ

Адаптивность компонентов (видимость иконок, текста, коротких текстов) управляется через CSS классы компонентов с вложенными селекторами. Подробности в `docs/doc-guide-ii.md` (раздел "Компоненты" → "Адаптивность компонентов").


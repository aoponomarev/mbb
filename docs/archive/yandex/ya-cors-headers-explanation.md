# Объяснение: Почему CORS заголовки не видны в JavaScript API

## Важно: Это НЕ ошибка!

**Ваши запросы работают корректно.** Если запрос проходит без ошибок CORS, значит всё настроено правильно.

## Почему заголовки не видны в JavaScript?

Браузеры **намеренно скрывают** CORS заголовки из JavaScript API (`response.headers.get()`) по соображениям безопасности. Это стандартное поведение всех современных браузеров.

### Как это работает:

1. **На сетевом уровне:** Заголовки CORS присутствуют в HTTP ответе
2. **В JavaScript API:** Браузер скрывает их от JavaScript кода
3. **Результат:** Запрос проходит успешно, но заголовки недоступны через API

## Как проверить, что заголовки действительно есть?

### Способ 1: DevTools Network Tab (РЕКОМЕНДУЕТСЯ)

1. Откройте DevTools (F12)
2. Перейдите на вкладку **Network**
3. Отправьте запрос через `ya-cors.html`
4. Найдите запрос к `functions.yandexcloud.net` в списке
5. Откройте его → вкладка **Headers**
6. В разделе **Response Headers** должны быть видны:
   ```
   Access-Control-Allow-Origin: *
   Access-Control-Allow-Methods: POST, OPTIONS
   Access-Control-Allow-Headers: Content-Type
   ```

### Способ 2: Через curl

```bash
curl -X POST https://functions.yandexcloud.net/d4erd8d1pttbufsl26s1 \
  -H "Content-Type: application/json" \
  -H "Origin: file://" \
  -d '{"modelUri":"gpt://b1gv03a122le5a934cqj/yandexgpt-lite/latest","messages":[{"role":"user","text":"Привет"}],"completionOptions":{"temperature":0.6,"maxTokens":2000},"apiKey":"YOUR_API_KEY"}' \
  -v
```

В выводе `-v` будут видны все заголовки ответа, включая CORS.

## Влияние на работу приложения

### ✅ НЕ КРИТИЧНО и НЕ ПОМЕШАЕТ

**Причины:**
1. Запросы проходят успешно
2. Ответы приходят корректно
3. Данные обрабатываются правильно
4. CORS заголовки работают на сетевом уровне

**Вывод:** Ваше приложение будет работать нормально. Браузер видит CORS заголовки и разрешает запросы, даже если JavaScript код их не видит.

## Почему браузер скрывает заголовки?

Это **мера безопасности**, чтобы предотвратить:
- Утечку информации о настройках CORS
- Атаки на основе анализа CORS политик
- Получение конфиденциальной информации через заголовки

## Рекомендации

1. **Не беспокойтесь** - если запросы проходят, всё работает правильно
2. **Проверьте через DevTools** - если хотите убедиться, что заголовки есть
3. **Используйте приложение** - если запросы проходят в тестах, они будут работать и в приложении

## ССЫЛКИ

- Код функции: `ya-cloud-function-code.md`
- Тестовая страница: `ya-cors.html`
- Конфигурация: `core/config/app-config.js`

# Правила для ИИ-агента

> Оглавление `.cursorrules`
- § Требования
  - *Базовые требования* — базовые правила для действий ИИ‑агента и общего стиля работы в репозитории.
  - *Требования к ведению документации* — правила работы с документацией и шапками файлов.
- § Понятия — определения используемых терминов (тематические логи, лог чата, протокол, тегирование).
- § Ограничения — правила работы с защищенными папками (`do-overs/`), коммиты только по команде.
- § Общие правила проекта — настройки и конфигурация проекта (`.vscode/`, `.cursorrules`).
- § Протоколы
  - *Протокол по командам "комить", "закомить всё" и т.п.* — сценарий действий для коммитов.
- `docs/doc-rules.md` — правила работы с документацией проекта.
- `docs/doc-architect.md` — архитектурный план, технологический стек, технические ограничения.

> § <br> ТРЕБОВАНИЯ К ИИ-АГЕНТУ

## Базовые требования
1. Строго следуй Правилам и документации: принципам, ограничениям, рекомендациям, паттернам и подходам. При конфликте между запросом пользователя и правилами проекта сделай остановку, предупреди пользователя о конфликте с правилами. Исполнение таких запросов возможно только после исправления правил документации.
2. При проектировании и поиске решений опирайся на существующие паттерны, компоненты и подходы, уже описанные в документации, а не изобретай новые без необходимости.
3. Распознавай команды пользователя и действуй по предписанным протоколам.

## Требования к ведению документации
- При редактировании используй сухой, сжатый, технократический стиль, стандартную терминологию разработки; формулируй точно и технически корректно; **заменяй жаргон, сленг, фразелогизмы, архаизмы, разговорные выражения, метафоры** (в т.ч. от пользователя);
- Соблюдай заданный стиль разметки и нумерацию разделов; **проверяй и исправляй нумерацию** после изменений структуры документа;
- Перед выполнением запроса выборочно перечитывай релевантные фрагменты документации в `docs/`, используя поиск и заголовки. Для простых задач — минимальный набор файлов, для сложных — расширяй круг документов. Основные документы: `docs/doc-architect.md` (архитектура, технологический стек), `docs/doc-rules.md` (правила работы с документацией);
- **Документирование в шапках файлов**: каждый файл должен содержать в шапке (в виде комментариев) описание базовых принципов его построения. Шапка должна объяснять: назначение файла, архитектурные принципы, как достигаются цели, почему выбраны такие решения. Если файлов несколько с однотипными принципами построения — эти принципы выносятся в `docs/doc-architect.md` с ссылкой из шапки файла. Формат шапки: заголовок с разделителями, раздел "ЦЕЛЬ" (назначение файла), разделы с описанием принципов (проблема → решение → как достигается → преимущества). Пример: `index.html` содержит развёрнутую шапку с принципами модульности; для других файлов с модульной загрузкой (например, `core/module-loader.js`, `core/template-loader.js`) принципы модульной загрузки выносятся в `docs/doc-architect.md`, а в шапках этих файлов остаются только специфичные для них принципы с ссылкой на общую документацию.

> § <br> ПОНЯТИЯ
- *Тематические логи* — файлы в папке `docs/logs/` с описанием коммитов, разбитым по темам, соответствующим вкладкам чатов агента: `log-Cursor.md`, `log-ARCH.md`, `log-HTML-CSS.md`, `log-DOCS.md`, `log-MM.md`. Заполняется по мере появления коммитов; при создании коммита запись добавляется БЕЗ хеша, хеши добавляются только при завершении рабочего дня.
- *Лог чата* — вся текущая дневная история переписки пользователя с ИИ-агентом.
- *Протокол* — сценарий действий по конкретной команде пользователя или в ответ на конкретную ситуацию. Протоколы описывают последовательность шагов для выполнения определенной задачи по запросу: протокол коммитов (по команде "комить"), протокол открытия дня (по команде "новый рабочий день"), протокол массовых правок (при обнаружении необходимости). Протоколы активируются по команде или при опознании необходимости.
- *Тегирование* — добавление ситуативных интуитивных тегов к записям в тематических логах для облегчения поиска. Теги размещаются отдельной строкой после `◉` в формате `@tag1 @tag2`. Теги должны отражать суть изменений и быть удобными для поиска: включать как общие категории (тип изменения, область), так и узкоспецифичные теги для точечного поиска (конкретные компоненты, функции, паттерны).

> § <br> ОГРАНИЧЕНИЯ
- `do-overs/` - запрещена запись и добавление файлов в staging, подробности: `do-overs/.cursorrules`.
- Коммиты только по явной команде пользователя.

> § <br> ОБЩИЕ ПРАВИЛА ПРОЕКТА
- Все настройки проекта находятся в папке `.vscode/`
- Синхронизация настроек происходит через файл `.cursorrules`
- Правила работы с документацией: `docs/doc-rules.md`

> § <br> ПРОТОКОЛЫ

## ПРОТОКОЛ ПО КОМАНДАМ "КОМИТЬ", "ЗАКОМИТЬ ВСЁ" И Т.П.
1. Выполни `git status`, убедись, что все необходимые изменения в staging.
2. Определи затронутые темы по содержимому изменений: Cursor (настройки проекта) или MBB (ARCH, HTML-CSS, DOCS, MM - разработка приложения). Анализируй каждый файл/изменение и определяй соответствующую тему независимо от текущей вкладки чата.
3. Разделение коммита: Если изменения затрагивают и настройки (Cursor), и разработку (MBB) — раздели на два коммита:
   - Первый коммит: только файлы разработки (код приложения, документация проекта и т.п.) → тема MBB
   - Второй коммит: только файлы настроек (`.vscode/`, `.cursorrules`, `.gitignore` и т.п.) → тема Cursor (настроечные коммиты бывают редко)
   - Каждый коммит фиксируется в соответствующем тематическом логе.
4. Сформируй краткое и технически точное название для каждого коммита.
5. В каждой затронутой теме добавь запись в `docs/logs/*.md`: `log-Cursor.md`, `log-ARCH.md`, `log-HTML-CSS.md`, `log-DOCS.md`, `log-MM.md`:
   - **ВАЖНО**: Распределяй изменения по логам строго по содержимому и тематике изменений, а не по текущей вкладке чата. Один коммит может содержать изменения для нескольких логов (например, `.cursorrules` → log-Cursor.md, `docs/.cursorrules` → log-DOCS.md; или для MBB: изменения архитектуры → log-ARCH.md, изменения разметки и стилей → log-HTML-CSS.md, изменения документации → log-DOCS.md, изменения математических моделей → log-MM.md). Поэтому описывай каждую запись одного и того же коммита исключительно в модальности своего лога (только те изменения коммита, которые касались темы лога).
   - используй обратный хронологический порядок (всегда добавляй запись в начало лога);
   - формат записи:
     заголовок `## Коммит от DD.MM.YYYY : <имя>` (без хеша, хеш добавляется только при завершении рабочего дня),
     строки `◆ ...` (что сделано), `▶ ...` (как сделано), `◉ ...` (для чего), `Тегирование` (@tag1 @tag2...)
     Для малозначимых/технических/корректурных изменений описание максимально краткое.
   - Описание должно базироваться на истории "лог чата" и быть полностью согласованным с кодовой базой.
   - Не создавай коммит, пока все изменения не отражены в тематических логах.
6. Выполни `git add` для всех файлов коммита (включая `docs/logs/*.md`), затем `git commit -m "имя коммита"`, проверь `git status`.



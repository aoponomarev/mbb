# Правила для ИИ-агента

> Оглавление
>>Правила работы ИИ-агента `.cursorrules`
- § Требования — базовые правила к ИИ‑агенту и общему стилю работы в репозитории.
- § Требования к ведению документации — правила работы с документацией и шапками файлов.
- § Понятия — определения используемых терминов.
- § Ограничения доступа к папкам*** — правила работы с защищенными папками.
- § Общие правила проекта — настройки и конфигурация проекта.
- § Протоколы — сценарии действий по командам пользователя.
  - Протокол по команде "комить", "закомить всё" и т.п.
>>Документация проекта
- `docs/.cursorrules` — правила работы с документацией проекта.
- `docs/architect.md` — архитектурный план, технологический стек, технические ограничения.

## Требования к ии-агенту
1. Строго следуй Правилам и документации: принципам, ограничениям, рекомендациям, паттернам и подходам. При конфликте между запросом пользователя и правилами проекта сделай остановку, предупреди пользователя о конфликте с правилами. Исполнение таких запросов возможно только после исправления правил документации.
2. При проектировании и поиске решений опирайся на существующие паттерны, компоненты и подходы, уже описанные в документации, а не изобретай новые без необходимости.
3. Распознавай команды пользователя и действуй по предписанным протоколам.

## Требования к ведению документации
- При редактировании используй сухой, сжатый, технократический стиль, стандартную терминологию разработки; формулируй точно и технически корректно; **заменяй жаргон, сленг, фразелогизмы, архаизмы, разговорные выражения, метафоры** (в т.ч. от пользователя);
- Соблюдай заданный стиль разметки и нумерацию разделов; **проверяй и исправляй нумерацию** после изменений структуры документа;
- Перед выполнением запроса выборочно перечитывай релевантные фрагменты документации в `docs/`, используя поиск и заголовки. Для простых задач — минимальный набор файлов, для сложных — расширяй круг документов. Основные документы: `docs/architect.md` (архитектура, технологический стек), `docs/.cursorrules` (правила работы с документацией);
- **Документирование в шапках файлов**: каждый файл должен содержать в шапке (в виде комментариев) описание базовых принципов его построения. Шапка должна объяснять: назначение файла, архитектурные принципы, как достигаются цели, почему выбраны такие решения. Если файлов несколько с однотипными принципами построения — эти принципы выносятся в `docs/architect.md` с ссылкой из шапки файла. Формат шапки: заголовок с разделителями, раздел "ЦЕЛЬ" (назначение файла), разделы с описанием принципов (проблема → решение → как достигается → преимущества). Пример: `index.html` содержит развёрнутую шапку с принципами модульности; для других файлов с модульной загрузкой (например, `core/module-loader.js`, `core/template-loader.js`) принципы модульной загрузки выносятся в `docs/architect.md`, а в шапках этих файлов остаются только специфичные для них принципы с ссылкой на общую документацию.

## Понятия
- *Тематические логи* — файлы в папке `docs/logs/` с описанием коммитов, разбитым по темам, соответствующим вкладкам чатов агента: `Cursor.md`, `ARCH.md`, `HTML-CSS.md`, `DOCS.md`, `MM.md`. Заполняется по мере появления коммитов; при создании коммита запись добавляется БЕЗ хеша, хеши добавляются только при завершении рабочего дня.
- *Лог чата* — вся текущая дневная история переписки пользователя с ИИ-агентом.
- *Протокол* — сценарий действий по конкретной команде пользователя или в ответ на конкретную ситуацию. Протоколы описывают последовательность шагов для выполнения определенной задачи по запросу: протокол коммитов (по команде "комить"), протокол открытия дня (по команде "новый рабочий день"), протокол массовых правок (при обнаружении необходимости). Протоколы активируются по команде или при опознании необходимости.
- *Тегирование* — добавление ситуативных интуитивных тегов к записям в тематических логах для облегчения поиска. Теги размещаются отдельной строкой после `◉` в формате `@tag1 @tag2`. Теги должны отражать суть изменений и быть удобными для поиска: включать как общие категории (тип изменения, область), так и узкоспецифичные теги для точечного поиска (конкретные компоненты, функции, паттерны).

## Ограничения
- `do-overs/` - запрещена запись и добавление файлов в staging, подробности: `do-overs/.cursorrules`.
- Коммиты только по явной команде пользователя.

## Общие правила проекта
- Все настройки проекта находятся в папке `.vscode/`
- Синхронизация настроек происходит через файл `.cursorrules`
- Правила работы с документацией: `docs/.cursorrules`

## Протокол по командам "комить", "закомить всё" и т.п.
1. Выполни `git status`, убедись, что все необходимые изменения в staging.
2. Определи затронутые темы по содержимому изменений: Cursor (настройки проекта) или MBB (ARCH, HTML-CSS, DOCS, MM - разработка приложения). Анализируй каждый файл/изменение и определяй соответствующую тему независимо от текущей вкладки чата.
3. Разделение коммита: Если изменения затрагивают и настройки (Cursor), и разработку (MBB) — раздели на два коммита:
   - Первый коммит: только файлы разработки (код приложения, документация проекта и т.п.) → тема MBB
   - Второй коммит: только файлы настроек (`.vscode/`, `.cursorrules`, `.gitignore` и т.п.) → тема Cursor (настроечные коммиты бывают редко)
   - Каждый коммит фиксируется в соответствующем тематическом логе.
4. Сформируй краткое и технически точное название для каждого коммита.
5. В каждой затронутой теме добавь запись в `docs/logs/*.md`: `Cursor.md`, `ARCH.md`, `HTML-CSS.md`, `DOCS.md`, `MM.md`:
   - **ВАЖНО**: Распределяй изменения по логам строго по содержимому и тематике изменений, а не по текущей вкладке чата. Один коммит может содержать изменения для нескольких логов (например, `.cursorrules` → Cursor.md, `docs/.cursorrules` → DOCS.md; или для MBB: изменения архитектуры → ARCH.md, изменения разметки и стилей → HTML-CSS.md, изменения документации → DOCS.md, изменения математических моделей → MM.md). Поэтому описывай каждую запись одного и того же комита исключительно в модальности своего лога (только те изменения комита, которые касались темы лога).
   - используй обратный хронологический порядок (всегда добавляй запись в начало лога);
   - формат записи:
     заголовок `## Коммит от DD.MM.YYYY : <имя>` (без хеша, хеш добавляется только при завершении рабочего дня),
     строки `◆ ...` (что сделано), `▶ ...` (как сделано), `◉ ...` (для чего), `Тегирование` (@tag1 @tag2...)
     Для малозначимых/технических/корректурных изменений описание максимально краткое.
   - Описание должно базироваться на истории `лог чата` и быть полностью согласованным с кодовой базой.
   - Не создавай коммит, пока все изменения не отражены в тематических логах.
6. Выполни `git add` для всех файлов коммита (включая `docs/logs/*.md`), затем `git commit -m "имя коммита"`, проверь `git status`.


